<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Movie - BookNow</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/add_movie.css') }}">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="{{ url_for('main.index') }}">
                    <h1>Book<span>Now</span></h1>
                </a>
            </div>
            <ul class="nav-links">
                <li><a href="{{ url_for('main.index') }}">Home</a></li>
                <li><a href="{{ url_for('main.all_movies') }}">Movies</a></li>
                <li><a href="#" class="active">Add Movie</a></li>
            </ul>
            <div class="nav-auth">
                <div class="profile-dropdown">
                    <button class="profile-icon" id="profileToggle">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <circle cx="12" cy="8" r="3"></circle>
                            <path d="M6.168 18.849A4 4 0 0 1 10 16h4a4 4 0 0 1 3.834 2.855"></path>
                        </svg>
                    </button>
                    <div class="dropdown-menu" id="profileMenu">
                        <a href="{{ url_for('user.profile') }}" class="dropdown-item">
                            <span class="dropdown-icon">üë§</span>
                            My Profile
                        </a>
                        <a href="{{ url_for('user.settings') }}" class="dropdown-item">
                            <span class="dropdown-icon">‚öôÔ∏è</span>
                            Settings
                        </a>
                        {% if user_data and (user_data.role == 'theatre_owner' or user_data.role == 'admin') %}
                            <div class="dropdown-divider"></div>
                            <a href="{{ url_for('theatre.theatre_dashboard') }}" class="dropdown-item">
                                <span class="dropdown-icon">üìä</span>
                                Theatre Dashboard
                            </a>
                            <a href="{{ url_for('movie.add_movie') }}" class="dropdown-item">
                                <span class="dropdown-icon">üé¨</span>
                                Add Movie
                            </a>
                        {% endif %}
                        {% if user_data and user_data.role == 'admin' %}
                            <div class="dropdown-divider"></div>
                            <a href="{{ url_for('admin.admin') }}" class="dropdown-item">
                                <span class="dropdown-icon">üõ°Ô∏è</span>
                                Admin Panel
                            </a>
                        {% endif %}
                        <div class="dropdown-divider"></div>
                        <a href="{{ url_for('auth.logout') }}" class="dropdown-item">
                            <span class="dropdown-icon">üö™</span>
                            Logout
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-container">
                {% for category, message in messages %}
                    <div class="flash-message flash-{{ category }}">
                        {{ message }}
                        <button class="close-flash">&times;</button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Add Movie Section -->
    <section class="profile-section">
        <div class="container">
            <div class="settings-header">
                <h1>üé¨ Add New Movie</h1>
                <p>Add a new movie to the BookNow platform</p>
            </div>

            <div class="settings-container">
                <div class="profile-card">
                    <div class="card-header">
                        <h3>Movie Details</h3>
                    </div>
                    <div class="card-body">
                        <form method="POST" action="{{ url_for('movie.add_movie') }}" class="settings-form">
                            <div class="form-group">
                                <label for="title">Movie Title *</label>
                                <input type="text" id="title" name="title" placeholder="Enter movie title" required>
                            </div>

                            <div class="form-group">
                                <label for="description">Movie Description *</label>
                                <textarea id="description" name="description" rows="4" placeholder="Enter a brief synopsis of the movie" required></textarea>
                                <small>Provide a compelling description to attract viewers</small>
                            </div>

                            <div class="form-group">
                                <label for="poster_url">Poster URL *</label>
                                <input type="url" id="poster_url" name="poster_url" placeholder="Enter poster image URL" required>
                                <small>Use a direct link to an image (e.g., https://example.com/image.jpg)</small>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="director">Director *</label>
                                    <input type="text" id="director" name="director" placeholder="Director name" required>
                                </div>

                                <div class="form-group">
                                    <label for="cast">Lead Cast *</label>
                                    <input type="text" id="cast" name="cast" placeholder="e.g., Actor 1, Actor 2" required>
                                    <small>Comma-separated list of lead actors</small>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="duration">Duration (minutes) *</label>
                                    <input type="number" id="duration" name="duration" min="1" placeholder="e.g., 150" required>
                                </div>

                                <div class="form-group">
                                    <label for="release_date">Release Date *</label>
                                    <input type="date" id="release_date" name="release_date" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="language">Language *</label>
                                <select id="language" name="language" required>
                                    <option value="">Select language</option>
                                    <option value="Hindi">Hindi</option>
                                    <option value="English">English</option>
                                    <option value="Tamil">Tamil</option>
                                    <option value="Telugu">Telugu</option>
                                    <option value="Malayalam">Malayalam</option>
                                    <option value="Kannada">Kannada</option>
                                    <option value="Bengali">Bengali</option>
                                    <option value="Marathi">Marathi</option>
                                    <option value="Punjabi">Punjabi</option>
                                </select>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="genre">Genre(s) *</label>
                                        <select id="genre" name="genre" multiple size="5" required>
                                            <option value="Action">Action</option>
                                            <option value="Comedy">Comedy</option>
                                            <option value="Drama">Drama</option>
                                            <option value="Horror">Horror</option>
                                            <option value="Romance">Romance</option>
                                            <option value="Sci-Fi">Sci-Fi</option>
                                            <option value="Thriller">Thriller</option>
                                            <option value="Adventure">Adventure</option>
                                            <option value="Animation">Animation</option>
                                            <option value="Fantasy">Fantasy</option>
                                            <option value="Documentary">Documentary</option>
                                        </select>
                                        <small>You can select multiple genres (Ctrl/Cmd + click)</small>
                                </div>

                                <div class="form-group">
                                    <label for="certificate">Certification</label>
                                    <select id="certificate" name="certificate">
                                        <option value="">Select certification</option>
                                        <option value="U">U (Universal)</option>
                                        <option value="U/A">U/A (Parental Guidance)</option>
                                        <option value="A">A (Adults Only)</option>
                                        <option value="S">S (Restricted to Special Class)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="trailer_url">Trailer URL</label>
                                <input type="url" id="trailer_url" name="trailer_url" placeholder="YouTube or other video URL">
                                <small>Optional - link to movie trailer</small>
                            </div>

                            {% if all_theatres %}
                            <div class="form-group">
                                <label for="theatre_id">Select Theatre *</label>
                                <select id="theatre_id" name="theatre_id" required>
                                    <option value="">Choose a theatre</option>
                                    {% for t in all_theatres %}
                                    <option value="{{ t._id }}">{{ t.name }} - {{ t.city }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            {% else %}
                            <div class="form-group">
                                <label for="theatre_id">Theatre</label>
                                <input type="text" value="{{ theatre.name }} - {{ theatre.city }}" disabled class="disabled-input">
                                <input type="hidden" id="theatre_id" name="theatre_id" value="{{ theatre._id }}">
                            </div>
                            {% endif %}

                            <div class="form-group" id="screenListContainer" style="display: none;">
                                <label>Available Screens</label>
                                <select id="screen_id" {% if all_theatres %}disabled{% endif %}>
                                    {% if all_theatres %}
                                    <option value="">Select a theatre first</option>
                                    {% else %}
                                    <option value="">Screen options will appear per show</option>
                                    {% for screen in screens %}
                                    <option value="{{ screen._id }}">{{ screen.name }} (Capacity: {{ screen.seating_capacity }})</option>
                                    {% endfor %}
                                    {% endif %}
                                </select>
                                <small>Each show can be assigned to a different screen</small>
                            </div>

                            <div class="form-group">
                                <label for="total_shows">Total Shows *</label>
                                <select id="total_shows" name="total_shows" required>
                                    <option value="">Select number of shows</option>
                                    <option value="1">1 Show</option>
                                    <option value="2">2 Shows</option>
                                    <option value="3">3 Shows</option>
                                    <option value="4">4 Shows</option>
                                    <option value="5">5 Shows</option>
                                    <option value="6">6 Shows</option>
                                </select>
                                <small>Choose how many shows to create</small>
                            </div>

                            <div id="showTimesContainer" class="show-times-container" style="display: none;">
                                <label>Show Details *</label>
                                <div id="showTimeInputs" class="show-time-inputs"></div>
                                <small>Enter the date and time for each show</small>
                            </div>

                            <div class="form-buttons">
                                <button type="submit" class="btn btn-primary">Add Movie</button>
                                <a href="{{ url_for('user.settings') }}" class="btn btn-outline">Cancel</a>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Preview Section -->
                <div class="profile-card">
                    <div class="card-header">
                        <h3>Preview</h3>
                    </div>
                    <div class="card-body">
                        <div class="movie-preview">
                            <div class="movie-card">
                                <div class="movie-poster">
                                    <img id="preview-image" src="https://images.unsplash.com/photo-1594908900066-3f47337549d8?w=400&h=600&fit=crop" alt="Preview">
                                    <div class="movie-overlay">
                                        <button class="btn btn-primary">Book Now</button>
                                    </div>
                                </div>
                                <div class="movie-info">
                                    <h3 id="preview-title">Movie Title</h3>
                                    <div class="movie-meta">
                                        <span class="rating">‚≠ê <span id="preview-rating">0.0</span></span>
                                        <span class="genre" id="preview-genre">Genre</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Book<span>Now</span></h3>
                    <p>Your ultimate destination for hassle-free movie ticket booking. Experience cinema like never before.</p>
                    <div class="social-links">
                        <a href="#" class="social-icon">üìò</a>
                        <a href="#" class="social-icon">üê¶</a>
                        <a href="#" class="social-icon">üì∑</a>
                        <a href="#" class="social-icon">‚ñ∂Ô∏è</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="{{ url_for('main.index') }}">Home</a></li>
                        <li><a href="{{ url_for('main.all_movies') }}">Movies</a></li>
                        <li><a href="{{ url_for('main.index') }}#why-us">Why Us</a></li>
                        <li><a href="{{ url_for('theatre.theatre_dashboard') }}">Dashboard</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="#">Help Center</a></li>
                        <li><a href="#">Terms of Service</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Contact Us</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <ul>
                        <li>üìß support@booknow.com</li>
                        <li>üìû +1 (555) 123-4567</li>
                        <li>üìç 123 Movie Street, Cinema City</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 BookNow. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/common.js') }}"></script>
    <script src="{{ url_for('static', filename='js/add_movie.js') }}"></script>
</body>
</html>
